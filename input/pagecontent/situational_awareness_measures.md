<!-- situational_awareness_measures.md {% comment %}
*****************************************************************************************
*                            WARNING: DO NOT EDIT THIS FILE                             *
*                                                                                       *
* This file is generated by SUSHI. Any edits you make to this file will be overwritten. *
*                                                                                       *
* To change the contents of this file, edit the original source file at:                *
* ig-data\input\pagecontent\situational_awareness_measures.md                           *
*****************************************************************************************
{% endcomment %} -->
According to The American HeritageÂ® Stedman's Medical Dictionary:
<blockquote>
<dl>
<dt>
measure <i>v.</i>
</dt>
<dd>
To ascertain the dimensions, quantity, or capacity of.
</dd>
<dd>
To mark, lay out, or establish dimensions for by measuring.
</dd>
</dl>
</blockquote>

At its simplest, measurement is counting in units, and then doing some math with
the resulting count or to obtain a value that lets you do something useful.

The focus of this guide is to inform developers on how to create and use the essential FHIR
Resources necessary to support national and regional reporting efforts on COVID-19 to
public health officials in the United States.

For more than the last decade, HL7 and its members have been deeply involved in the evolution
of measurement standards for quality reporting, from early efforts in developing the
[HL7 Version 3 Health Quality Measure Format](https://www.hl7.org/implement/standards/product_brief.cfm?product_id=97)
specification, to more recent efforts in the publication of the [HL7 FHIR Quality Measure (QM)](http://hl7.org/fhir/us/cqfmeasures/),
and the [DaVinci Data Exchange For Quality Measures (DEQM)](http://hl7.org/fhir/us/davinci-deqm/)
implementation guides. These guides provide excellent reference and background materials
for those interested in learning more about the terminology used in measurement.


This implementation guide uses the [MeasureReport](https://hl7.org/fhir/R4/MeasureReport)
resource to report measures to regional and federal agencies, including state departments
of public health, the Centers for Disease Control (CDC) and the Federal Emergency Management
Agency.  In late March of this year, the CDC [published a form](https://www.cdc.gov/nhsn/pdfs/covid19/57.130-covid19-pimhc-blank-p.pdf)
and [instructions](https://www.cdc.gov/nhsn/pdfs/covid19/57.130-toi-508.pdf) for hospital reporting of
bed and ventilator utilization, and FEMA [provided a spreadsheet](Template for Daily Hospital COVID-19 Reporting.xlsx) it expects to be
emailed on a daily basis from in-hospital laboratory testing facilities.  Examples of
these documents are provided below.

<table><caption>Samples of requested data. Show for illustration, please use
official sources for reporting.</caption>
<tbody>
<tr>
  <td><img width='80%' src='Template-for-Daily-Hospital-COVID-19-Reporting.png'/></td>
  <td><img width='80%' src='57.130-covid19-pimhc-blank-p.png'/></td>
</tr>
</tbody>
</table>

Each of the entries in these spreadsheets or forms is measure or count of groups
of things such as available beds, ventilators, tests ordered, et cetera.  The completed
spreadsheet or form is a Measure Report.  Accompanying instructions describe (to a human)
what to include in a group.  A conceptual model of these artifacts appears below.

![Conceptual Model](ConceptualModel.svg)

The HL7 FHIR standard has similarly named resources that perform the same functions.
A more detailed model about how these are related follows.
* [MeasureReport](https://hl7.org/fhir/R4/MeasureReport)
* [Measure](https://hl7.org/fhir/R4/Measure)


![Model](Model.svg)

### Measurement Reporting Approach
The approach of this IG to measurement is to capture all measures reported to a single
agency in a single Measure, with multiple groups in the measure.  This is very much
treating MeasureReport as if it were a report card (as one might receive from a school)
reporting how a location is doing on all measured criteria, with each group within the
MeasureReport reflecting one of the "subject areas" being measured, much like a report
card reports on a student's progress in different subjects.

Unlike a report card, a Measure Report is not necessarily an evaluation of how a location
is performing its function. The number of patients in the hospital due to pandemic is
not related to how well the hospital performs, and much more due to other factors, such
as the density of the local population, or the implementation of appropriate measures to
contain the pandemic that are outside the control of the location that is being measured.
These MeasureReport resources should be viewed not as a critique of a given facility,
rather, an evaluation of the impact the pandemic is having upon a facility.

Combining reporting into a single MeasureReport would result in data loss on the Measure
Resource without the ability to express attributes of each Measured item at the group
level.  That issue is addressed by this Implementation Guide by creating an extension (see [Measure
Group Attributes](#supporting-profiles) below) to allow topic, scoring and type to be shifted from Measure to
Measure.group. To simplify interpretation of Measure by consumers, Measures created
in this guide always include these extensions on Measure.group, even if they are not strictly
needed.  A tracker will be created (#TODO: Create Tracker) to suggest moving these classifiers
to group.


### Measures for Situational Awareness
Just as [quality reporting](https://www.hl7.org/fhir/clinicalreasoning-quality-reporting.html) defines several types of measures, situational
awareness measures also follow several common patterns.

The purpose of situation awareness measures is to collect essential elements of information (EEI) used to support emergency response. Briefly, EEIs are the data elements
emergency response officials need in order to critical support decision making during an emergency.  In the US, the Office of the Assistant Secretary of
Preparedness and Response [defines EEIs](https://www.phe.gov/Preparedness/planning/hpp/reports/Documents/hpp-pmi-guidance-2017.pdf#page=54) as:

> Essential Elements of Information (EEI)
> : Essential elements of information are discrete types of reportable public health or healthcare-related incident-specific knowledge communicated or received
> concerning a particular fact or circumstance, preferably reported in a standardized manner or format, which assists in generating situational awareness for
> decision-making purposes. EEI are often coordinated and agreed upon pre-incident (and communicated to local partners) as part of information collection request
> templates and emergency response playbooks.

This is a healthcare focused definition of EEIs, rather than a more general definition of the term, but the term EEEI is also used in other domains.  A more detailed
discussion of Essential Elements of Information addressing broader domain needs (including healthcare) can be found in
[Essential Elements of Information Publication Guidance](https://www.nisconsortium.org/portal/resources/bin/NISC_EEI_Publication_1426695387.pdf)
published by the National Information Sharing Consortium.

Measures developed using this profile need not be confined to a health system, they might also be applied to other kinds of facilities required to report
EEIs in support of emergency response (e.g., measures about essential workforce members, or the food distribution, or even different forms of housing).
Many of the principles of measurement will still apply even though the measurement is performed outside of the healthcare domain.

In the ideal world:

1. EEIs will be well defined and understood before a crisis occurs, but may need to evolve as a crisis evolves and more is understood about the emerging
situation.
2. Systems that have EEIs will be able to automatically collect and report it to organizations responsible for emergency response.
Time spent manually collecting and reporting data that is not automated often suffers in quality[^1].
3. New and changed EEI criteria can be automatically deployed, and those reporting systems can be rapidly updated to respond to changing information needs.

A discussion of automating measure collection can be found at [Computing Meassures](measure_automation.html).

[^1]: Overhage JM, Grannis S, McDonald CJ. A comparison of the completeness and timeliness of automated electronic
laboratory reporting and spontaneous reporting of notifiable conditions. Am J Public Health. 2008 Feb;98(2):344-50.
doi: 10.2105/AJPH.2006.092700. Epub 2008 Jan 2. PMID: 18172157; PMCID: PMC2376898.
Available on the web at <https://pubmed.ncbi.nlm.nih.gov/18172157/>

Examing the data being captured for Situational Awareness during the COVID-19 crisis, this guide has identified the following types
of measures:

* Capacity or Utilization
* Current and Cumulative Event Counting (Event Growth)
* Queue Length
* Service Times
* Availability

### Capacity and Utilization
A Capacity and Utilitization measure describes the current capacity and utilization of fixed assets for treatment,
and provides scores showing used and available capacity. It is a specialization of a
[Proportion Measure](https://www.hl7.org/fhir/R4/codesystem-measure-scoring.html#measure-scoring-proportion).
The total system capacity is the denominator for the measure. There can be exclusions from the denominator to
count resources that are temporarily unavailable for care for reasons other than being used for treatment. The
utilization component is the numerator. It describes the number of units in use for treatment. The availability
component is the numerator-complement which describes thee number of units available for use. The measure score
is computed as for a proportion measure.

The difference between is Proportion Measure and a Utilization measure is that in a proportion measure available
capacity must be inferred, however, in a Utilization measure, the available capacity is directly reported in
a measurement in the numerator-complement population of the measure.  This implementation guide defines the code for
the the numerator-complement population.

In this way, the MeasureReport resource reporting utilization can be directly queried through FHIR APIs for
available capacity to find a location capable of treating or caring for some number of patients (e.g., by available beds
or ventilators at a facility or within a region).

### Event Growth
An event growth measure reports the number of events occuring during a time period (e.g., tests performed,
positive test results, new cases) over the cumulative total of events (e.g., total tests performed, total
positive results, or total cases) from some defined starting point.  The numerator is the number events occuring
during the period, and the denominator is the cumulative total of events. It represents the point in time rate
of growth during the measure period of events of interest.

This is simply another form of Proportion measure, since what is being counted in the numerator and denominator come from the
same initial population.

The [Covid Trends](https://aatishb.com/covidtrends/) site demonstrates use of this measure in a graph to show the
trajectory of confirmed cases. When plotted over time on a log-log scale, this kind of measure illustrates significant changes in events with
exponential rates of growth. An example plot is shown below:

![Graph of Covid Trends in the World as of July 25, 2020](CovidTrends.png)

### Queue Length
A Queue Length measure is a cohort measure which reports the number of activities awaiting completion (e.g., patients in an overflow
area waiting for a bed, tests awaiting to be resulted, patients in a hospital awaiting discharge). Queue length usually represents
a measure of an unmet need. Queue length measures can be improved to become service time measures by capturing the total time waiting
for an completion of an activity, but this time may not be readily tracked, or queue length may be a sufficient signal of a problem
that needs to be addressed. The benefit of service time measures is that they can be compared betweeen facilities, whereas queue length
is not readily comparable but may be more readily computable.

### Service Time
A Service Time measure is a specialization of the ratio meausure which reports the total time taken to provide a service
(e.g., wait times, length of stay, time to report a lab test result) for all events in the numerator, and the total number
of events (e.g., services such as inpatient stays, tests performed) provided in the denominator. This is a ratio measure because
the units differ in the numerator and denominator, where the events being counted in the numerator are essentially clock ticks in
some unit (e.g., days, hours, minutes).  The measure score is the average service time. These are generally process measures,
describing the efficacy of the process being measured (e.g., treatment, testing).

Service time measures must report both the total number of events (the denominator) and the total time of service (the numerator)
to support aggregation over time. Consider an organization reporting measures about time taken to produce test result, where
one site results tests in 22.0 hours, and another site reports tests in 12.0 hours.  The rate across both sites together cannot be
computed if the number of tests is not reported.  If the first site performed 100 tests, and the second performed 1000 tests, then
the rate across both sites will be different if the quantities of tests performed is swapped.  This is shown in the two tables below:

<table border='1' cellspacing='0' cols='5' rows='4' border='1'>
  <caption>Case 1: Site 1 reports on 100 tests, Site 2 on 1000</caption>
  <thead>
    <tr><th>Site</th><th>Average Rate</th><th>Tests Performed</th><th>Total Time</th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>100</td><td> 2,200 hrs</td><td>22.0 hrs/result</td></tr>
    <tr><td>2</td><td>1000</td><td>12,000 hrs</td><td>12.0 hrs/result</td></tr>
    <tr><td>All</td><td>1100</td><td>14,200 hrs</td><td>12.9 hrs/result</td></tr>
  </tbody>
</table><br/>

<table border='1' cellspacing='0' cols='5' rows='4' border='1'>
  <caption>Case 2: Site 1 reports on 1000 tests, Site 2 on 100</caption>
  <thead>
    <tr><th>Site</th><th>Tests Performed</th><th>Total Time</th><th>Average Rate</th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>1000</td><td>22,000 hrs</td><td>22.0 hrs/result</td></tr>
    <tr><td>2</td><td>100</td><td> 1,200 hrs</td><td>12.0 hrs/result</td></tr>
    <tr><td>All</td><td>1100</td><td>23,200 hrs</td><td>21.1 hrs/result</td></tr>
  </tbody>
</table>

#### Availability
Availability measures are subtypes of cohort measures which enable tracking of availability of
critical resources, generally consumables (e.g., PPE, medications, immunizations, oxygen, blood, IV fluids),
and can also report availability of staff to support facility operations (e.g., physicans, nurses,
other licensed providers, support and maintenance staff), or other resources (e.g., electricity, water)
or available facility services (e.g., emergency department, helipad, burn unit).

Availability measures are generally "yes/no" to indicate availability where a facility record
a measure value of 1 if sufficent quantity is available to meet demand, and 0 otherwise.  These
can be further stratified based on degree of availability (e.g., by days supply remaining).

Availability measures can also report whether conservation measures have been implemented
(e.g., N95 mask reuse after sterilization), and whether equivalent resupplies are readily available
using the same mechanism for recording yes/no answers.

A measure report for a single facility **shall** always have a value of 0 or 1 as the count for
an availability measure.  When unstratified, a 1 **shall** mean available, a 0 **shall** mean unavailable.
When stratified the count for each stratum **shall** always be 1 or 0, where a 1 **shall** mean the facility
meets the criteria for a specified stratum, and a 0 **shall** mean it does not.  There **shall** be at most
one stratum whose count is 1, and **should** be one stratum whose count is 1. The sum of values for all
strata **shall** be 0 or 1.

A measure report aggregating over multiple facilities or over reporting periods may have a value greater
than one (the sum of all count values for all aggregated reports).  The number "counts" the number of
facilities or time periods for which the identified resource is available, or within strata, the number
of facilities or time periods for which the stratification criteria were met.

### Measure Populations in Situation Awareness Measures
In addition to initial population, denominator, denominator-exclusions and numerators, situational awareness measures
may report other populations or population scores.  Unlike quality measures, situational awareness measures do not
use denominator exceptions.  This implementation guide defines three additional types of populations:

* Numerator Complement
* Duration
* Duration Squared

#### Numerator Complement
The numerator complement is the quantity in the denominator that match neither the numerator the numerator exclusion criteria.
Summed together, the numerator, numerator-exclusion and numerator-complement must match the value of the
denominator - denominator-exclusion value.

In a capacity and utilization measure, the numerator-complement population represents available capacity. By enabling reporting
of available capacity in a measure report, the numerator-complement enables search for locations with available capacity meeting
a specific criteria (e.g., an ICU with 10 open beds, or a hospital with 3 available ventilators).

#### Duration
Duration is a measure-observation provided with time units representing the duration of an activity or event
(e.g. length of stay, time to admission, time for service).

#### Duration Squared
Like Duration, duration-squared is a measure-observation. It represents the sum of squares duration of an activity or event. This value can be used
to support computation of variance in time of service measures. Increases in variation over time represent areas where service times are changing, and measures
of variance allow for hypotheses testing about the distribution of measured events.

#### Specifying Population Criteria

<table rows='12'>
  <thead>
    <tr><th>MeasureType</th><th>Initial Population</th>
        <th>Denominator</th><th>Denominator Exclusion</th>
        <th>Numerator</th><th>Numerator Exclusion</th><th>Numerator Complement</th>
        <th>Duration</th><th>Duration Squared</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Capacity and Utilization</td>
      <td>R</td>
      <td>R</td><td>O</td>
      <td>R</td><td>O</td><td>R</td>
      <td>NP</td><td>NP</td>
    </tr>
    <tr><td>Event Growth</td>
      <td>R</td>
      <td>R</td><td>O</td>
      <td>R</td><td>O</td><td>NP</td>
      <td>NP</td><td>NP</td>
    </tr>
    <tr><td>Queue Length</td>
      <td>R</td>
      <td>NP</td><td>NP</td>
      <td>NP</td><td>NP</td><td>NP</td>
      <td>NP</td><td>NP</td>
    </tr>
    <tr><td>Service Time</td>
      <td>R</td>
      <td>R</td><td>O</td>
      <td>NP</td><td>NP</td><td>NP</td>
      <td>R</td><td>O</td>
    </tr>
    <tr><td>Availability</td>
      <td>R</td>
      <td>R</td><td>O</td>
      <td>R</td><td>O</td><td>R</td>
      <td>NP</td><td>NP</td>
    </tr>
  </tbody>
</table>

### Optionality in Situation Awareness Measures
A measure may contain sections for reporting that are either not appropriate or not applicable for all settings.
In order to pass FHIR Validation, a MeasureReport that references a Measure must however, include all components
of the measure.  At the time of this publication, these constraints are hard coded into FHIR Validation tools, and
are not generally available in computable form. When reporting these elements, the
[data-absent-reason](https://www.hl7.org/fhir/extension-data-absent-reason.html) extension can be used in the
MeasureReport resource for these elements to indicate that they are not available.

To enable measure developers to specify which measure components are required, recommended or optional
this IG defines the [Measure Expectation](StructureDefinition-measure-expectation.html) extension. This
extension operates identically to the https://www.hl7.org/fhir/extension-capabilitystatement-expectation.html
extension, but can be applied to Measure resources.



### Profiles
* [Public Health Measure](StructureDefinition-PublicHealthMeasure.html) profiles the
  Measure resource to support Public Health and Emergency Response surveillance requirements.

* [Public Health Measure Report](StructureDefinition-PublicHealthMeasureReport.html)
  profiles the MeasureReport Resource to align it with resources adopting the Public
  Health Measure profile.

### Supporting Profiles
* [Measure Criteria](StructureDefinition-MeasureCriteria.html) profiles the
  [Expression](https://www.hl7.org/fhir/R4/metadatatypes.html#Expression) data type
  to enforce requirements essential for the creation of measures supporting automatic
  evaluation and reporting.

* [Measured Item Description](StructureDefinition-MeasuredItemDescription.html) provides
  how to code what is to be counted to identify:

  1. The FHIR Resource to be used for counting.
  2. A code or ValueSet describing the subtypes of that resource to include in the count.

### Supporting Extensions
* [Measure Population Alternate Criteria](StructureDefinition-MeasurePopulationAlternateCriteria.html)
  defines an extension that allows alternate criteria for evaluation to be defined for
  a Measure.  In this way, multiple implementations for counting can be supported based
  on the capabilities of the system available.

* [Measure Group Attributes](StructureDefinition-MeasureGroupAttributes.html) defines
  an extension that enables interpretation the structure of a group as a collection
  of populations that evaluate to a single measured item.


### Predefined Measures
This implementation guide includes two predefined measures describing the measurements
that are required to be reported to CDC/NHSN and FEMA.

* [CDC/NHSN Patient Impact and Hospital Capacity Reporting Measures](Measure-CDCPatientImpactAndHospitalCapacity.html)
  defines a measure that is aligned with the reporting required by the
  [National Healthcare Safety Network (CDC/NHSN)](https://www.cdc.gov/nhsn/index.html) using the COVID-19 Patient Impact and
  Hospital Capacity module, and

* [FEMA Daily Hospital COVID-19 Reporting Measures](Measure-FEMADailyHospitalCOVID19Reporting.html)
  defines a measure that is aligned with the reporting required by the [Federal Emergency Management Agency (FEMA)](https://www.aha.org/advisory/2020-03-30-coronavirus-update-administration-requests-hospitals-report-daily-covid-19)
  for reporting COVID-19 test results from Hospital in-house laboratories.

Additional reporting requirements have already been established by these Federal agencies.
This implementation guide will be updated as feasible to include measures for those reports
as time allows.

